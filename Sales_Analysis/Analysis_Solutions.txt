
#1 Show unique car models in the dataset?  


  SELECT DISTINCT Model FROM mytable;


#2 Find the total number of cars sold? 


  SELECT COUNT(*) AS Total_Cars_Sold FROM mytable;


#3 List the number of cars sold per dealer?

  
  SELECT Dealer_Name, COUNT(*) AS Cars_Sold
  FROM mytable
  GROUP BY Dealer_Name
  ORDER BY Cars_Sold DESC;


#4 Find the total revenue generated from car sales? 
  
  
  SELECT SUM(Price_) AS Total_Revenue FROM mytable;


#5 What is the total revenue generated by each dealer?



 SELECT Dealer_Name, SUM(Price_) AS Total_Revenue
 FROM mytable
 GROUP BY Dealer_Name
 ORDER BY Total_Revenue DESC;


#6 List the top 5 combinations of Company & Model that generated the highest revenue?


 SELECT Company, Model, SUM(Price_) AS Total_Revenue
 FROM mytable
 GROUP BY Company, Model
 ORDER BY Total_Revenue DESC
 LIMIT 5;


#7 Find the top-selling color for each body style?


 SELECT Body_Style, Color, COUNT(*) AS Color_Count
 FROM mytable
 GROUP BY Body_Style, Color
 HAVING Color_Count = (
    SELECT MAX(Color_Count) 
    FROM (SELECT Body_Style, Color, COUNT(*) AS Color_Count 
    FROM mytable 
    GROUP BY Body_Style, Color) AS subquery
    WHERE subquery.Body_Style = mytable.Body_Style
 );


#8 Find the percentage of male vs female customers who purchased cars?


SELECT Gender, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM mytable) AS Percentage
FROM mytable
GROUP BY Gender;



#9 What is the most popular engine type based on the number of sales?



SELECT Engine, COUNT(*) AS Sales_Count
FROM mytable
GROUP BY Engine
ORDER BY Sales_Count DESC
LIMIT 1;



#10 Find the customer with the highest purchase amount in each dealer region?




WITH RankedCustomers AS (
    SELECT Dealer_Region, Customer_Name, SUM(Price_) AS Total_Spent,
    RANK() OVER (PARTITION BY Dealer_Region ORDER BY SUM(Price_) DESC) AS Rank
    FROM mytable
    GROUP BY Dealer_Region, Customer_Name
)
SELECT Dealer_Region, Customer_Name, Total_Spent
FROM RankedCustomers
WHERE Rank = 1;




#11 Find the most expensive car sold in each dealer region?



WITH RankedCars AS (
    SELECT Dealer_Region, Model, Price_,
           RANK() OVER (PARTITION BY Dealer_Region ORDER BY Price_ DESC) AS Rank
    FROM mytable
)
SELECT Dealer_Region, Model, Price_
FROM RankedCars
WHERE Rank = 1;



#12 Rank dealers by their total revenue and show the percentage difference from the top dealer?



WITH DealerRevenue AS (
    SELECT Dealer_Name, SUM(Price_) AS Total_Revenue
    FROM mytable
    GROUP BY Dealer_Name
), RankedDealers AS (
    SELECT Dealer_Name, Total_Revenue,
           RANK() OVER (ORDER BY Total_Revenue DESC) AS Rank,
           (Total_Revenue / (SELECT MAX(Total_Revenue) FROM DealerRevenue)) * 100 AS Percentage_Of_Top
    FROM DealerRevenue
)
SELECT * FROM RankedDealers;



#13 Calculate the total revenue generated per company and rank them from highest to lowest?




SELECT Company, SUM(Price_) AS Total_Revenue
FROM mytable
GROUP BY Company
ORDER BY Total_Revenue DESC;




#14 Find the top 3 customers who have spent the most on car purchases?



SELECT Customer_Name, SUM(Price_) AS Total_Spent
FROM mytable
GROUP BY Customer_Name
ORDER BY Total_Spent DESC
LIMIT 3;


# I HOPE IT MAY HELPFUL

# THANKS YOU

